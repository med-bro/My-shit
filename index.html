<!DOCTYPE html>
<html>
<head>
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Weekly Study Tracker</title>
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

<style>
body { font-family: Arial; background:#f0f0f0; padding:10px; }

table { width:100%; border-collapse:collapse; margin-top:15px; }
th, td { border:1px solid #aaa; padding:5px; text-align:center; }

button { width:100%; padding:5px; }

.charts {
  display:flex;
  flex-direction:column;
  gap:20px;
  margin-top:20px;
}
</style>

</head>
<body>

<h2 id="title"></h2>

<table>
<thead>
<tr>
<th>Science</th>

<th colspan="4">Week 1</th>
<th colspan="4">Week 2</th>
<th colspan="4">Week 3</th>
<th colspan="4">Week 4</th>

</tr>
</thead>

<tbody id="tableBody"></tbody>
</table>

<div class="charts">
<canvas id="mathDonut"></canvas>
<canvas id="pcDonut"></canvas>
<canvas id="svtDonut"></canvas>
</div>

<script>

// ===== FIXED POINTS (YOUR EXACT RULES) =====

const math = [20,20,20,40];
const pc   = [25,20,35,20];
const svt  = [20,20,45,15];

// storage for pressed sessions
let data = {
math: Array(16).fill(0),
pc:   Array(16).fill(0),
svt:  Array(16).fill(0)
};

// show current month
document.getElementById("title").innerText =
"Monthly Progress - " + new Date().toLocaleString('default',{month:'long'});

// build table row
function buildRow(name, arr){

let html = `<tr><td><b>${name}</b></td>`;

for(let i=0;i<16;i++){

let points;

if(name=="Math") points = math[i%4];
if(name=="PC")   points = pc[i%4];
if(name=="SVT")  points = svt[i%4];

html += `<td>
<button onclick="press('${name.toLowerCase()}',${i},${points})">
${points}
</button>
</td>`;
}

html += "</tr>";

return html;
}

// create table
document.getElementById("tableBody").innerHTML =
buildRow("Math") +
buildRow("PC") +
buildRow("SVT");

// when user presses a session button
function press(science,index,points){

data[science][index] = points;

updateCharts();
}

// helper sum function
function sum(a){ return a.reduce((x,y)=>x+y,0); }

// ====== DONUT CHARTS ======

let mathChart = new Chart(document.getElementById("mathDonut"),{
type:"doughnut",
data:{ labels:["Math"], datasets:[{ data:[0,100] }] },
options:{ plugins:{ title:{ display:true, text:"Math Progress"} } }
});

let pcChart = new Chart(document.getElementById("pcDonut"),{
type:"doughnut",
data:{ labels:["PC"], datasets:[{ data:[0,100] }] },
options:{ plugins:{ title:{ display:true, text:"PC Progress"} } }
});

let svtChart = new Chart(document.getElementById("svtDonut"),{
type:"doughnut",
data:{ labels:["SVT"], datasets:[{ data:[0,100] }] },
options:{ plugins:{ title:{ display:true, text:"SVT Progress"} } }
});

// update charts
function updateCharts(){

let m = sum(data.math);
let p = sum(data.pc);
let s = sum(data.svt);

mathChart.data.datasets[0].data = [m, 100-m];
pcChart.data.datasets[0].data   = [p, 100-p];
svtChart.data.datasets[0].data  = [s, 100-s];

mathChart.update();
pcChart.update();
svtChart.update();
}

// ===== DAILY REMINDER AT 11:00 =====

if(Notification.permission!="granted")
Notification.requestPermission();

setInterval(()=>{

let now = new Date();

if(now.getHours()==11 && now.getMinutes()==0){
new Notification("Reminder: Enter your study points for today!");
}

},60000);

</script>

</body>
</html>
